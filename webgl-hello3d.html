<html>

<head>
<title>WebGL Hello World (3D)</title>
<script src="gl-matrix.js"></script>
<script src="common.js"></script>
<script type="text/javascript">
    var gl;
    var canvas;
    var shader = {};
    var displist = {};
    
    function draw() {
        shader.uniforms.hoge.value = 0.5;
        shader.set_uniforms();
        displist.draw(function(){
            displist.begin(gl.TRIANGLES);
            displist.color(1, 0, 0);
            displist.vertex2(1, 0);
            displist.color(0, 1, 0);
            displist.vertex2(0, 1);
            displist.color(0, 0, 1);   
            displist.vertex2(0, 0);
            displist.end();
        });
    }
    function init() {
        canvas = document.getElementById("canvas");
        gl = canvas.getContext("experimental-webgl");
        gl.viewportWidth = canvas.width;
        gl.viewportHeight = canvas.height;
        if (!gl)
            alert("Could not initialise WebGL, sorry :-(");
        var vertex_shader_src = "\
            attribute vec3 a_position;\
            attribute vec3 a_color;\
            varying vec3 v_color;\
            void main(void) {\
                gl_Position = vec4(a_position, 1.0);\
                v_color = a_color;\
            }\
            ";
        var fragment_shader_src = "\
            precision mediump float;\
            varying vec3 v_color;\
            uniform float u_hoge;\
            void main(void) {\
                gl_FragColor = vec4(v_color * u_hoge, 1.0);\
            }\
            ";
        shader = get_shader(gl, vertex_shader_src, fragment_shader_src);
        shader.add_uniform("hoge", "1f");

        displist = get_displist(gl, shader.program);
        displist.add_vertex_attribute("color", 3);
    }
</script>


</head>


<body onload="init();draw();">
    <canvas id="canvas" width="640" height="480"></canvas>
</body>

</html>
